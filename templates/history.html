<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>İmtahan Tarixçəsi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>body { font-family: 'Inter', sans-serif; background: #f1f5f9; }</style>
</head>
<body class="py-12 px-4">
    <div class="max-w-6xl mx-auto">
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-slate-900">İmtahan Tarixçəsi</h1>
                <p class="text-slate-500 mt-1">Keçmiş imtahan nəticələriniz</p>
            </div>
            <a href="/" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">
                <i class="ri-home-4-line mr-2"></i>Ana Səhifə
            </a>
        </div>

        {% if results %}
        <div class="space-y-6">
            {% for result in results %}
            <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                <div class="p-6 border-b border-gray-50 bg-gray-50/50">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-bold text-gray-900">{{ result.subject.name }}</h3>
                            <p class="text-gray-600">{{ result.exam_date.strftime('%d.%m.%Y %H:%M') }}</p>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-blue-600">{{ result.total_score }}/50</div>
                            <div class="text-sm text-gray-500">Ümumi Xal</div>
                        </div>
                    </div>
                </div>
                
                <div class="p-6">
                    <h4 class="font-semibold text-gray-900 mb-4">Sual Cavabları</h4>
                    <div class="space-y-4">
                        {% for answer in result.answers %}
                        <div class="border border-gray-100 rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div class="text-sm text-gray-600">Sual {{ loop.index }}</div>
                                <div class="text-sm font-medium text-green-600">{{ answer.points }}/{{ answer.max_points }} xal</div>
                            </div>
                            <div class="text-sm text-gray-800 mb-2">{{ answer.question.text | truncate(100) }}</div>
                            {% if answer.answer_text %}
                            <div class="text-sm bg-gray-50 p-2 rounded mb-2">
                                <strong>Sizin cavabınız:</strong> {{ answer.answer_text | truncate(200) }}
                            </div>
                            {% endif %}
                            {% if answer.image_path %}
                            <div class="mb-2">
                                <img src="{{ url_for('static', filename='uploads/' + answer.image_path) }}" class="h-20 w-auto rounded border">
                            </div>
                            {% endif %}
                            <div class="text-sm text-blue-600">
                                <strong>AI Rəyi:</strong> {{ answer.feedback | truncate(150) }}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-12">
            <i class="ri-file-list-3-line text-6xl text-gray-300 mb-4"></i>
            <h3 class="text-xl font-medium text-gray-900 mb-2">Hələ imtahan verməmisiniz</h3>
            <p class="text-gray-500 mb-6">İlk imtahanınızı vermək üçün ana səhifəyə qayıdın.</p>
            <a href="/" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">İmtahana Başla</a>
        </div>
        {% endif %}
    </div>
</body>
</html>